!function(){"use strict";var e={n:function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,{a:r}),r},d:function(t,r){for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.wp.element,r=window.wp.blocks,n=window.wp.blockEditor,l=window.wp.components,s=window.wp.i18n;const a=e=>"master"===e?(0,s.__)("Master's course","ftek-courses"):(0,s._x)("Year %$1s","grade","ftek-courses").replace("%$1s",e),o=e=>e.length>0?e.sort().map((e=>[[e]])).reduce(((e,t)=>{const r=e[e.length-1];return t[0][0]-r[r.length-1]==1?r.push(t[0][0]):e.push(t[0]),e})).map((e=>(0,s._x)("SP%$1s","study period","ftek-courses").replace("%$1s",e.length>1?e[0]+"-"+e[e.length-1]:e[0].toString()))).join(" "):(0,s._x)("SP","study period","ftek-courses"),c=["F","TM"],u=[1,2,3,4],i=["1","2","3","master"];var m=function(e){let{header:r,meta:n}=e;const l=[{text:(0,s.__)("Course homepage","ftek-courses"),url:n.homepage_url},{text:(0,s.__)("General info","ftek-courses"),url:n.info_url},{text:(0,s.__)("Latest survey","ftek-courses"),url:n.survey_url},...n.code?[{text:(0,s.__)("Exam statistics","ftek-courses"),url:`https://stats.ftek.se/${n.code}`}]:[]].filter((e=>e.url));return 0===l.length?(0,t.createElement)(t.Fragment,null):(0,t.createElement)(t.Fragment,null,r,(0,t.createElement)("ul",{style:{listStyle:"none",margin:0,padding:0}},l.map(((e,r)=>(0,t.createElement)("li",{key:r},(0,t.createElement)("a",{target:"_blank",rel:"noopener noreferrer",href:e.url},e.text))))))},d=function(e){let{options:r,checked:n,onChange:s}=e;return(0,t.createElement)(l.MenuGroup,null,r.map(((e,r)=>(0,t.createElement)(l.MenuItem,{key:r,icon:n.includes(e.value)?"yes":void 0,onClick:()=>{const t=n.indexOf(e.value),r=[...n];t>=0?r.splice(t,1):r.push(e.value),s(r)}},e.label))))},p={"course-list-header":"lPl84OrPHAyMc0pUzwj2","header-controls":"ffipdmyQQw2x4PbU7qWN","entries-count":"J0ItxDXXK10AIVQkiSB0","clear-filters":"ohShIRgQubzCB3rqIxu0","course-list-body":"lkMOAnZGiCRhjAGkQByo","course-list-footer":"lzO4wLRD9cG1Y0SEA2yw"};function _(e,t){return e.some((e=>t.includes(e)))}var f=window.wp.apiFetch,h=e.n(f),g=window.wp.url,E=function(){const[e,r]=(0,t.useState)(0),[n,f]=(0,t.useState)(10),[E,k]=(0,t.useState)(""),[w,v]=(0,t.useState)([...i]),[y,C]=(0,t.useState)([...c]),[b,S]=(0,t.useState)([...u]),x=function(e,r){const[n,l]=(0,t.useState)([]);return(0,t.useEffect)((()=>{n.length%100==0&&h()({...e,path:(0,g.addQueryArgs)(e.path,{per_page:100,offset:n.length})}).then((e=>{Array.isArray(e)&&e.length>0&&l([...n,...e])})).catch(console.error)}),[n,void 0]),n}({path:"/wp/v2/course-page"}),$=E.toLocaleLowerCase(),M=x.filter((e=>{const t=e.meta;return(e.title.rendered.toLowerCase().includes($)||e.meta.wp_ftek_course_pages_code.toLocaleLowerCase().includes($))&&(w.length===i.length||w.includes(t.wp_ftek_course_pages_year))&&(y.length===c.length||_(y,t.wp_ftek_course_pages_programs))&&(b.length===u.length||_(b,t.wp_ftek_course_pages_study_perionds))})).sort(((e,t)=>t.meta.wp_ftek_course_pages_participant_count-e.meta.wp_ftek_course_pages_participant_count));return(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",{className:p["course-list-header"]},(0,t.createElement)("div",{className:p["header-controls"]},(0,t.createElement)("div",{className:p["entries-count"]},(0,t.createElement)(l.SelectControl,{label:(0,s.__)("Entries to display","ftek-courses"),value:n,options:[{label:"10",value:10},{label:"20",value:20},{label:"50",value:50},{label:"100",value:100}],onChange:e=>{f(e),r(0)}})),(0,t.createElement)("div",{className:p["clear-filters"]},(0,t.createElement)(l.Button,{variant:"tertiary",onClick:()=>{v([...i]),C([...c]),S([...u]),r(0)}},(0,s.__)("Clear filters","ftek-courses")))),(0,t.createElement)("div",{className:p["header-search"]},(0,t.createElement)(l.TextControl,{label:(0,s._x)("Search","course page","ftek-courses"),value:E,onChange:e=>{k(e),r(0)}}))),(0,t.createElement)("div",{className:p["course-list-body"]},M.length>0?(0,t.createElement)("table",null,(0,t.createElement)("thead",null,(0,t.createElement)("tr",null,(0,t.createElement)("th",null,(0,s.__)("Course page","ftek-courses")),(0,t.createElement)("th",null,(0,s.__)("Course code","ftek-courses")),(0,t.createElement)("th",null,(0,s.__)("Credits","ftek-courses")),(0,t.createElement)("th",null,(0,t.createElement)("div",null,(0,s._x)("Year","grade","ftek-courses"),(0,t.createElement)(l.DropdownMenu,{icon:"filter"},(()=>(0,t.createElement)(t.Fragment,null,(0,t.createElement)(d,{options:i.map((e=>({label:a(e),value:e}))),checked:w,onChange:e=>{v(e),r(0)}}),(0,t.createElement)(d,{options:c.map((e=>({label:e,value:e}))),checked:y,onChange:e=>{C(e),r(0)}})))))),(0,t.createElement)("th",null,(0,t.createElement)("div",null,(0,s.__)("Study period","ftek-courses"),(0,t.createElement)(l.DropdownMenu,{icon:"filter"},(()=>(0,t.createElement)(d,{options:u.map((e=>({label:o([e]),value:e}))),checked:b,onChange:e=>{S(e),r(0)}}))))),(0,t.createElement)("th",null,(0,s.__)("Links","ftek-courses")))),(0,t.createElement)("tbody",null,M.slice(e*n,(e+1)*n).map(((e,r)=>{const n=(e=>Object.fromEntries(Object.entries(e).filter((e=>{let[t]=e;return t.startsWith("wp_ftek_course_pages_")})).map((e=>{let[t,r]=e;return[t.replace("wp_ftek_course_pages_",""),r]}))))(e.meta);return(0,t.createElement)("tr",{key:r},(0,t.createElement)("td",null,(0,t.createElement)("a",{href:e.link},e.title.rendered)),(0,t.createElement)("td",null,n.code||(0,s.__)("Course Code","ftek-courses")),(0,t.createElement)("td",null,(l=n.credits,(0,s._x)("%$1s hec","higher education credits","ftek-courses").replace("%$1s",(l||0).toString()))),(0,t.createElement)("td",null,((e,t)=>"master"===e?(0,s.__)("Master's course","ftek-courses"):t.length>0?t.sort().map((t=>t+e||"")).join(" "):(0,s._x)("Year","grade","ftek-courses"))(n.year,n.programs)),(0,t.createElement)("td",null,o(n.study_perionds)),(0,t.createElement)("td",null,(0,t.createElement)(m,{meta:n})));var l})))):(0,t.createElement)("p",null,(0,s.__)("No courses found","ftek-courses"))),(0,t.createElement)("div",{className:p["course-list-footer"]},(0,t.createElement)("small",null,(0,s.__)("Showing %$1s to %$2s of %$3s entries","ftek-courses").replace("%$1s",Math.min(e*n+1,M.length).toString()).replace("%$2s",Math.min((e+1)*n,M.length).toString()).replace("%$3s",M.length.toString())),(0,t.createElement)("span",null,(0,t.createElement)(l.Button,{variant:"tertiary",disabled:e<=0,onClick:()=>r(e-1)},(0,s._x)("Previous","course page","ftek-courses")),(0,t.createElement)(l.Button,{variant:"tertiary",disabled:(e+1)*n>=M.length,onClick:()=>r(e+1)},(0,s._x)("Next","course page","ftek-courses")))))},k=JSON.parse('{"apiVersion":2,"name":"ftek-courses/course-list","title":"Course list","category":"widgets","textdomain":"ftek-courses","style":"file:view.css","viewScript":"file:view.js","editorScript":"file:editor.js"}');(0,r.registerBlockType)(k,{edit:function(){return(0,t.createElement)("div",(0,n.useBlockProps)(),(0,t.createElement)(E,null))},save:function(){return(0,t.createElement)("div",n.useBlockProps.save())},icon:(0,t.createElement)((function(e){let{url:r,style:n}=e;return(0,t.createElement)("svg",{style:n},(0,t.createElement)("image",{style:{width:"100%"},xlinkHref:r}))}),{url:wpFtekCoursePagesCourseListEditor.iconUrl})})}();