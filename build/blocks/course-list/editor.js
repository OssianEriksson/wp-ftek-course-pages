!function(){"use strict";var e={n:function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,{a:r}),r},d:function(t,r){for(var a in r)e.o(r,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:r[a]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.wp.element,r=window.wp.blocks,a=window.wp.blockEditor,n=window.wp.components,l=window.wp.i18n,s=window.wp.apiFetch,o=e.n(s);const c=e=>"master"===e?(0,l.__)("Master's course","wp-ftek-course-pages"):(0,l._x)("Year %$1s","grade","wp-ftek-course-pages").replace("%$1s",e),u=e=>e.length>0?e.sort().map((e=>[[e]])).reduce(((e,t)=>{const r=e[e.length-1];return t[0][0]-r[r.length-1]==1?r.push(t[0][0]):e.push(t[0]),e})).map((e=>(0,l._x)("SP%$1s","study period","wp-ftek-course-pages").replace("%$1s",e.length>1?e[0]+"-"+e[e.length-1]:e[0].toString()))).join(" "):(0,l._x)("SP","study period","wp-ftek-course-pages"),p=["F","TM"],i=[1,2,3,4],m=["1","2","3","master"];var g=function(e){let{header:r,meta:a}=e;const n=[{text:(0,l.__)("Course homepage","wp-ftek-course-pages"),url:a.homepage_url},{text:(0,l.__)("General info","wp-ftek-course-pages"),url:a.info_url},{text:(0,l.__)("Latest survey","wp-ftek-course-pages"),url:a.survey_url},...a.code?[{text:(0,l.__)("Exam statistics","wp-ftek-course-pages"),url:`https://stats.ftek.se/${a.code}`}]:[]].filter((e=>e.url));return 0===n.length?(0,t.createElement)(t.Fragment,null):(0,t.createElement)(t.Fragment,null,r,(0,t.createElement)("ul",{style:{listStyle:"none",margin:0,padding:0}},n.map(((e,r)=>(0,t.createElement)("li",{key:r},(0,t.createElement)("a",{target:"_blank",rel:"noopener noreferrer",href:e.url},e.text))))))},d=function(e){let{options:r,checked:a,onChange:l}=e;return(0,t.createElement)(n.MenuGroup,null,r.map(((e,r)=>(0,t.createElement)(n.MenuItem,{key:r,icon:a.includes(e.value)?"yes":void 0,onClick:()=>{const t=a.indexOf(e.value),r=[...a];t>=0?r.splice(t,1):r.push(e.value),l(r)}},e.label))))};function _(e,t){return e.some((e=>t.includes(e)))}var f=function(){const[e,r]=(0,t.useState)(0),[a,s]=(0,t.useState)(10),[f,w]=(0,t.useState)(""),[h,E]=(0,t.useState)([...m]),[k,v]=(0,t.useState)([...p]),[y,C]=(0,t.useState)([...i]),[{posts:b,postsPage:S},x]=(0,t.useState)({posts:[],postsPage:1});(0,t.useEffect)((()=>{b.length===100*(S-1)&&o()({path:`/wp/v2/course-page?page=${S}&per_page=100`}).then((e=>{Array.isArray(e)&&e.length>0&&x({posts:[...b,...e],postsPage:S+1})})).catch((()=>{}))}),[b]);const $=b.filter((e=>{const t=e.meta;return e.title.rendered.toLowerCase().includes(f.toLocaleLowerCase())&&(h.length===m.length||h.includes(t.wp_ftek_course_pages_year))&&(k.length===p.length||_(k,t.wp_ftek_course_pages_programs))&&(y.length===i.length||_(y,t.wp_ftek_course_pages_study_perionds))})).sort(((e,t)=>t.meta.wp_ftek_course_pages_participant_count-e.meta.wp_ftek_course_pages_participant_count));return(0,t.createElement)("div",{className:"wp-ftek-course-pages-course-list"},(0,t.createElement)("div",{className:"course-list-header"},(0,t.createElement)("div",{className:"header-controls"},(0,t.createElement)("div",{className:"entries-count"},(0,t.createElement)(n.SelectControl,{label:(0,l.__)("Entries to display","wp-ftek-course-pages"),value:a,options:[{label:"10",value:10},{label:"20",value:20},{label:"50",value:50},{label:"100",value:100}],onChange:e=>{s(e),r(0)}})),(0,t.createElement)("div",{className:"clear-filters"},(0,t.createElement)(n.Button,{variant:"tertiary",onClick:()=>{E([...m]),v([...p]),C([...i]),r(0)}},(0,l.__)("Clear filters","wp-ftek-course-pages")))),(0,t.createElement)("div",{className:"header-search"},(0,t.createElement)(n.TextControl,{label:(0,l._x)("Search","course page","wp-ftek-course-pages"),value:f,onChange:e=>{w(e),r(0)}}))),(0,t.createElement)("table",null,(0,t.createElement)("thead",null,(0,t.createElement)("tr",null,(0,t.createElement)("th",null,(0,l.__)("Course page","wp-ftek-course-pages")),(0,t.createElement)("th",null,(0,l.__)("Course code","wp-ftek-course-pages")),(0,t.createElement)("th",null,(0,l.__)("Credits","wp-ftek-course-pages")),(0,t.createElement)("th",null,(0,t.createElement)("div",null,(0,l._x)("Year","grade","wp-ftek-course-pages"),(0,t.createElement)(n.DropdownMenu,{icon:"filter"},(()=>(0,t.createElement)(t.Fragment,null,(0,t.createElement)(d,{options:m.map((e=>({label:c(e),value:e}))),checked:h,onChange:e=>{E(e),r(0)}}),(0,t.createElement)(d,{options:p.map((e=>({label:e,value:e}))),checked:k,onChange:e=>{v(e),r(0)}})))))),(0,t.createElement)("th",null,(0,t.createElement)("div",null,(0,l.__)("Study period","wp-ftek-course-pages"),(0,t.createElement)(n.DropdownMenu,{icon:"filter"},(()=>(0,t.createElement)(d,{options:i.map((e=>({label:u([e]),value:e}))),checked:y,onChange:e=>{C(e),r(0)}}))))),(0,t.createElement)("th",null,(0,l.__)("Links","wp-ftek-course-pages")))),(0,t.createElement)("tbody",null,$.slice(e*a,(e+1)*a).map(((e,r)=>{const a=(e=>Object.fromEntries(Object.entries(e).filter((e=>{let[t]=e;return t.startsWith("wp_ftek_course_pages_")})).map((e=>{let[t,r]=e;return[t.replace("wp_ftek_course_pages_",""),r]}))))(e.meta);return(0,t.createElement)("tr",{key:r},(0,t.createElement)("td",null,(0,t.createElement)("a",{href:e.link},e.title.rendered)),(0,t.createElement)("td",null,a.code||(0,l.__)("Course Code","wp-ftek-course-pages")),(0,t.createElement)("td",null,(n=a.credits,(0,l._x)("%$1s hec","higher education credits","wp-ftek-course-pages").replace("%$1s",(n||0).toString()))),(0,t.createElement)("td",null,((e,t)=>"master"===e?(0,l.__)("Master's course","wp-ftek-course-pages"):t.length>0?t.sort().map((t=>t+e||"")).join(" "):(0,l._x)("Year","grade","wp-ftek-course-pages"))(a.year,a.programs)),(0,t.createElement)("td",null,u(a.study_perionds)),(0,t.createElement)("td",null,(0,t.createElement)(g,{meta:a})));var n})))),(0,t.createElement)("div",{className:"course-list-footer"},(0,t.createElement)("small",null,(0,l.__)("Showing %$1s to %$2s of %$3s entries","wp-ftek-course-pages").replace("%$1s",Math.min(e*a+1,$.length).toString()).replace("%$2s",Math.min((e+1)*a,$.length).toString()).replace("%$3s",$.length.toString())),(0,t.createElement)("span",null,(0,t.createElement)(n.Button,{variant:"tertiary",disabled:e<=0,onClick:()=>r(e-1)},(0,l._x)("Previous","course page","wp-ftek-course-pages")),(0,t.createElement)(n.Button,{variant:"tertiary",disabled:(e+1)*a>=$.length,onClick:()=>r(e+1)},(0,l._x)("Next","course page","wp-ftek-course-pages")))))},w=JSON.parse('{"apiVersion":2,"name":"wp-ftek-course-pages/course-list","title":"Course list","category":"widgets","textdomain":"wp-ftek-course-pages","style":"file:view.css","viewScript":"file:view.js","editorScript":"file:editor.js"}');(0,r.registerBlockType)(w,{edit:function(){return(0,t.createElement)("div",(0,a.useBlockProps)(),(0,t.createElement)(f,null))},save:function(){return(0,t.createElement)("div",a.useBlockProps.save())},icon:(0,t.createElement)((function(e){let{url:r,style:a}=e;return(0,t.createElement)("svg",{style:a},(0,t.createElement)("image",{style:{width:"100%"},xlinkHref:r}))}),{url:wpFtekCoursePagesCourseListEditor.iconUrl})})}();