!function(){"use strict";var e={n:function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,{a:r}),r},d:function(t,r){for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.wp.element,r=window.wp.blocks,n=window.wp.blockEditor,a=window.wp.i18n,l=window.wp.apiFetch,s=e.n(l),o=window.wp.url;const c=["F","TM"],p=[1,2,3,4],u=["1","2","3","master"];function i(e){let{posts:r,year:n,footnotes:l}=e;const s=["multiple",...c],o=Object.fromEntries(s.map((e=>[e,Math.max(...Object.values(r[e]).map((e=>e.length)))])));return Math.max(...Object.values(o))<=0?(0,t.createElement)("p",null,(0,a.__)("No courses found","wp-ftek-course-pages")):(0,t.createElement)("table",null,(0,t.createElement)("thead",null,(0,t.createElement)("tr",null,(0,t.createElement)("th",null),p.map(((e,r)=>(0,t.createElement)("th",{key:r},(0,a.__)("Study period %$1s","wp-ftek-course-pages").replace("%$1s",e.toString())))))),(0,t.createElement)("tbody",null,s.map(((e,s)=>{const c=r[e],u=o[e];return[...Array(o[e]).keys()].map((r=>(0,t.createElement)("tr",{key:`${s}.${r}`},0===r&&(0,t.createElement)("th",{rowSpan:u},"multiple"===e?(0,a._x)("Y%$1s","grade","wp-ftek-course-pages").replace("%$1s",n):((e,t)=>"master"===e?(0,a.__)("Master's course","wp-ftek-course-pages"):t.length>0?t.sort().map((t=>t+e||"")).join(" "):(0,a._x)("Year","grade","wp-ftek-course-pages"))(n,[e])),p.flatMap(((e,n)=>{if(r>c[e].length)return[];if(r===c[e].length)return[(0,t.createElement)("td",{key:n,rowSpan:u-r})];const a=c[e][r];return[(0,t.createElement)("td",{key:n},(0,t.createElement)("a",{href:a.link},a.title),a.comments.map(((e,r)=>{const n=l[e];return(0,t.createElement)("sup",{key:r},r>0&&",",(0,t.createElement)("a",{href:`#table-footnote-${n}`},n))})))]})))))}))))}function m(){const e=function(e,r){const[n,a]=(0,t.useState)([]);return(0,t.useEffect)((()=>{n.length%100==0&&s()({...e,path:(0,o.addQueryArgs)(e.path,{per_page:100,offset:n.length})}).then((e=>{Array.isArray(e)&&e.length>0&&a([...n,...e])})).catch(console.error)}),[n,void 0]),n}({path:"/wp/v2/course-page"}),r=Object.fromEntries(u.filter((e=>"master"!==e)).map((e=>[e,Object.fromEntries([...c,"multiple"].map((e=>[e,Object.fromEntries(p.map((e=>[e,[]])))])))])));let n=1;const l=(0,a.__)("Elective course","wp-ftek-course-pages"),m={};e.forEach((e=>{const{wp_ftek_course_pages_programs:t,wp_ftek_course_pages_year:a,wp_ftek_course_pages_study_perionds:s,wp_ftek_course_pages_comment:o,wp_ftek_course_pages_elective:c}=e.meta;if(t.length<=0||!a)return;const p=[...c?[l]:[],...o?[o]:[]];p.forEach((e=>{e in m||(m[e]=n++)}));const u=t.length>1?"multiple":t[0];s.forEach((t=>{r[a][u][t].push({title:e.title.rendered,link:e.link,comments:p})}))}));const f=Object.entries(m);return(0,t.createElement)("div",{className:"table-wrapper"},u.filter((e=>"master"!==e)).map(((e,n)=>(0,t.createElement)(t.Fragment,{key:n},(0,t.createElement)("h3",null,(0,a._x)("Year %$1s","grade","wp-ftek-course-pages").replace("%$1s",e)),(0,t.createElement)(i,{year:e,posts:r[e],footnotes:m})))),f.length>0&&(0,t.createElement)("p",null,f.map(((e,r)=>{let[n,a]=e;return(0,t.createElement)(t.Fragment,{key:r},r>0&&(0,t.createElement)("br",null),(0,t.createElement)("span",{id:`table-footnote-${a}`},(0,t.createElement)("sup",null,a),n))}))))}var f=JSON.parse('{"apiVersion":2,"name":"wp-ftek-course-pages/course-table","title":"Course table","category":"widgets","textdomain":"wp-ftek-course-pages","style":"file:view.css","viewScript":"file:view.js","editorScript":"file:editor.js"}');(0,r.registerBlockType)(f,{edit:function(){return(0,t.createElement)("div",(0,n.useBlockProps)(),(0,t.createElement)(m,null))},save:function(){return(0,t.createElement)("div",n.useBlockProps.save())},icon:(0,t.createElement)((function(e){let{url:r,style:n}=e;return(0,t.createElement)("svg",{style:n},(0,t.createElement)("image",{style:{width:"100%"},xlinkHref:r}))}),{url:wpFtekCoursePagesCourseTableEditor.iconUrl})})}();